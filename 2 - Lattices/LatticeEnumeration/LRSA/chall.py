from Crypto.Util.number import *
from secret import flag


def keygen():
    p,q = getPrime(512), getPrime(512)
    x = getRandomInteger(512)
    a,b = getRandomNBitInteger(500), getRandomNBitInteger(500)
    a,b = a*x, b*x
    c = a*p + b*q
    return (a,b,c), (p,q)


def encrypt_priv(m, priv):
    p, q = priv
    n = p*q
    assert m < n
    return pow(m, 0x10001, n)


pub, priv = keygen()
ct = encrypt_priv(bytes_to_long(flag), priv)
print(f'{ct = }')
print(f'{pub = }')
"""
ct = 62818049451844130066544084308842540071082488863680727760560794334193284759945284282361022467248427723833976899284847446503158710281544666599641088998964239393887837688101457039795257255252789272980753628158669503135043170249505518090485617464855136135375695470949478575808638991395487049265670382803283262979
pub = (20315220434888286087957078448040648285679641923331653574408879032284326288770810098150865087384202009797089937209857758711663674898432795988148111174304173198020225322150395384891995060460199145895730461888713113394938220227918441775459478532347086762571253317271173257132689464294879580824559762495058178, 18987398555188829872832660674905173126514411243473432571589490787862487855073182736281358074297777231507149256938589989939623604918436111709491869451460290233271116401163561915506155481066746423535398790065413451407718918126684998928790819813608615111743556839174248067344033363588749740318947090798169060, 415438593861346977962916899465014430021182425691306152459339944883974199339883734334744495037358168720809989963968471594468534650401092296177163149232810386114259763005672076477251490166110860507628632265270901760495355239000886211129565050763052595865391121407447009493030272204905951742442254629082936518488767153422813023101105487828422574040626809330697681794839022998934631271553777264336843240863666401394891817368783144540271659460631237766994802368574)
"""